// Version 1.3.2 three-geojson-geometry - https://github.com/vasturiano/three-geojson-geometry
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).THREE=t.THREE||{},t.THREE)}(this,(function(t,n){"use strict";function e(t,n,e){return n=u(n),function(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,r()?Reflect.construct(n,e||[],u(t).constructor):n.apply(t,e))}function r(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(r=function(){return!!t})()}function o(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:String(n)}function i(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function a(t,n){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},a(t,n)}function f(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,u,a=[],f=!0,c=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;f=!1}else for(;!(f=(r=i.call(e)).done)&&(a.push(r.value),a.length!==n);f=!0);}catch(t){c=!0,o=t}finally{try{if(!f&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(t,n)||c(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,n){if(t){if("string"==typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function s(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var v={exports:{}};function p(t,n,e){e=e||2;var r,o,i,u,a,f,c,l=n&&n.length,s=l?n[0]*e:t.length,v=x(t,0,s,e,!0),p=[];if(!v||v.next===v.prev)return p;if(l&&(v=function(t,n,e,r){var o,i,u,a=[];for(o=0,i=n.length;o<i;o++)(u=x(t,n[o]*r,o<i-1?n[o+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),a.push(P(u));for(a.sort(w),o=0;o<a.length;o++)e=M(a[o],e);return e}(t,n,v,e)),t.length>80*e){r=i=t[0],o=u=t[1];for(var h=e;h<s;h+=e)(a=t[h])<r&&(r=a),(f=t[h+1])<o&&(o=f),a>i&&(i=a),f>u&&(u=f);c=0!==(c=Math.max(i-r,u-o))?32767/c:0}return y(v,p,e,r,o,c,0),p}function x(t,n,e,r,o){var i,u;if(o===H(t,n,e,r)>0)for(i=n;i<e;i+=r)u=B(i,t[i],t[i+1],u);else for(i=e-r;i>=n;i-=r)u=B(i,t[i],t[i+1],u);return u&&_(u,u.next)&&(R(u),u=u.next),u}function h(t,n){if(!t)return t;n||(n=t);var e,r=t;do{if(e=!1,r.steiner||!_(r,r.next)&&0!==j(r.prev,r,r.next))r=r.next;else{if(R(r),(r=n=r.prev)===r.next)break;e=!0}}while(e||r!==n);return n}function y(t,n,e,r,o,i,u){if(t){!u&&i&&function(t,n,e,r){var o=t;do{0===o.z&&(o.z=Z(o.x,o.y,n,e,r)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var n,e,r,o,i,u,a,f,c=1;do{for(e=t,t=null,i=null,u=0;e;){for(u++,r=e,a=0,n=0;n<c&&(a++,r=r.nextZ);n++);for(f=c;a>0||f>0&&r;)0!==a&&(0===f||!r||e.z<=r.z)?(o=e,e=e.nextZ,a--):(o=r,r=r.nextZ,f--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;e=r}i.nextZ=null,c*=2}while(u>1)}(o)}(t,r,o,i);for(var a,f,c=t;t.prev!==t.next;)if(a=t.prev,f=t.next,i?g(t,r,o,i):d(t))n.push(a.i/e|0),n.push(t.i/e|0),n.push(f.i/e|0),R(t),t=f.next,c=f.next;else if((t=f)===c){u?1===u?y(t=b(h(t),n,e),n,e,r,o,i,2):2===u&&m(t,n,e,r,o,i):y(h(t),n,e,r,o,i,1);break}}}function d(t){var n=t.prev,e=t,r=t.next;if(j(n,e,r)>=0)return!1;for(var o=n.x,i=e.x,u=r.x,a=n.y,f=e.y,c=r.y,l=o<i?o<u?o:u:i<u?i:u,s=a<f?a<c?a:c:f<c?f:c,v=o>i?o>u?o:u:i>u?i:u,p=a>f?a>c?a:c:f>c?f:c,x=r.next;x!==n;){if(x.x>=l&&x.x<=v&&x.y>=s&&x.y<=p&&O(o,a,i,f,u,c,x.x,x.y)&&j(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function g(t,n,e,r){var o=t.prev,i=t,u=t.next;if(j(o,i,u)>=0)return!1;for(var a=o.x,f=i.x,c=u.x,l=o.y,s=i.y,v=u.y,p=a<f?a<c?a:c:f<c?f:c,x=l<s?l<v?l:v:s<v?s:v,h=a>f?a>c?a:c:f>c?f:c,y=l>s?l>v?l:v:s>v?s:v,d=Z(p,x,n,e,r),g=Z(h,y,n,e,r),b=t.prevZ,m=t.nextZ;b&&b.z>=d&&m&&m.z<=g;){if(b.x>=p&&b.x<=h&&b.y>=x&&b.y<=y&&b!==o&&b!==u&&O(a,l,f,s,c,v,b.x,b.y)&&j(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,m.x>=p&&m.x<=h&&m.y>=x&&m.y<=y&&m!==o&&m!==u&&O(a,l,f,s,c,v,m.x,m.y)&&j(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;b&&b.z>=d;){if(b.x>=p&&b.x<=h&&b.y>=x&&b.y<=y&&b!==o&&b!==u&&O(a,l,f,s,c,v,b.x,b.y)&&j(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;m&&m.z<=g;){if(m.x>=p&&m.x<=h&&m.y>=x&&m.y<=y&&m!==o&&m!==u&&O(a,l,f,s,c,v,m.x,m.y)&&j(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function b(t,n,e){var r=t;do{var o=r.prev,i=r.next.next;!_(o,i)&&A(o,r,r.next,i)&&I(o,i)&&I(i,o)&&(n.push(o.i/e|0),n.push(r.i/e|0),n.push(i.i/e|0),R(r),R(r.next),r=t=i),r=r.next}while(r!==t);return h(r)}function m(t,n,e,r,o,i){var u=t;do{for(var a=u.next.next;a!==u.prev;){if(u.i!==a.i&&S(u,a)){var f=z(u,a);return u=h(u,u.next),f=h(f,f.next),y(u,n,e,r,o,i,0),void y(f,n,e,r,o,i,0)}a=a.next}u=u.next}while(u!==t)}function w(t,n){return t.x-n.x}function M(t,n){var e=function(t,n){var e,r=n,o=t.x,i=t.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var a=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=o&&a>u&&(u=a,e=r.x<r.next.x?r:r.next,a===o))return e}r=r.next}while(r!==n);if(!e)return null;var f,c=e,l=e.x,s=e.y,v=1/0;r=e;do{o>=r.x&&r.x>=l&&o!==r.x&&O(i<s?o:u,i,l,s,i<s?u:o,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(o-r.x),I(r,t)&&(f<v||f===v&&(r.x>e.x||r.x===e.x&&E(e,r)))&&(e=r,v=f)),r=r.next}while(r!==c);return e}(t,n);if(!e)return n;var r=z(e,t);return h(r,r.next),h(e,e.next)}function E(t,n){return j(t.prev,t,n.prev)<0&&j(n.next,t,t.next)<0}function Z(t,n,e,r,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-e)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*o|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function P(t){var n=t,e=t;do{(n.x<e.x||n.x===e.x&&n.y<e.y)&&(e=n),n=n.next}while(n!==t);return e}function O(t,n,e,r,o,i,u,a){return(o-u)*(n-a)>=(t-u)*(i-a)&&(t-u)*(r-a)>=(e-u)*(n-a)&&(e-u)*(i-a)>=(o-u)*(r-a)}function S(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&A(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}(t,n)&&(I(t,n)&&I(n,t)&&function(t,n){var e=t,r=!1,o=(t.x+n.x)/2,i=(t.y+n.y)/2;do{e.y>i!=e.next.y>i&&e.next.y!==e.y&&o<(e.next.x-e.x)*(i-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==t);return r}(t,n)&&(j(t.prev,t,n.prev)||j(t,n.prev,n))||_(t,n)&&j(t.prev,t,t.next)>0&&j(n.prev,n,n.next)>0)}function j(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function _(t,n){return t.x===n.x&&t.y===n.y}function A(t,n,e,r){var o=G(j(t,n,e)),i=G(j(t,n,r)),u=G(j(e,r,t)),a=G(j(e,r,n));return o!==i&&u!==a||(!(0!==o||!T(t,e,n))||(!(0!==i||!T(t,r,n))||(!(0!==u||!T(e,t,r))||!(0!==a||!T(e,n,r)))))}function T(t,n,e){return n.x<=Math.max(t.x,e.x)&&n.x>=Math.min(t.x,e.x)&&n.y<=Math.max(t.y,e.y)&&n.y>=Math.min(t.y,e.y)}function G(t){return t>0?1:t<0?-1:0}function I(t,n){return j(t.prev,t,t.next)<0?j(t,n,t.next)>=0&&j(t,t.prev,n)>=0:j(t,n,t.prev)<0||j(t,t.next,n)<0}function z(t,n){var e=new F(t.i,t.x,t.y),r=new F(n.i,n.x,n.y),o=t.next,i=n.prev;return t.next=n,n.prev=t,e.next=o,o.prev=e,r.next=e,e.prev=r,i.next=r,r.prev=i,r}function B(t,n,e,r){var o=new F(t,n,e);return r?(o.next=r.next,o.prev=r,r.next.prev=o,r.next=o):(o.prev=o,o.next=o),o}function R(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function H(t,n,e,r){for(var o=0,i=n,u=e-r;i<e;i+=r)o+=(t[u]-t[i])*(t[i+1]+t[u+1]),u=i;return o}v.exports=p,v.exports.default=p,p.deviation=function(t,n,e,r){var o=n&&n.length,i=o?n[0]*e:t.length,u=Math.abs(H(t,0,i,e));if(o)for(var a=0,f=n.length;a<f;a++){var c=n[a]*e,l=a<f-1?n[a+1]*e:t.length;u-=Math.abs(H(t,c,l,e))}var s=0;for(a=0;a<r.length;a+=3){var v=r[a]*e,p=r[a+1]*e,x=r[a+2]*e;s+=Math.abs((t[v]-t[x])*(t[p+1]-t[v+1])-(t[v]-t[p])*(t[x+1]-t[v+1]))}return 0===u&&0===s?0:Math.abs((s-u)/u)},p.flatten=function(t){for(var n=t[0][0].length,e={vertices:[],holes:[],dimensions:n},r=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var u=0;u<n;u++)e.vertices.push(t[o][i][u]);o>0&&(r+=t[o-1].length,e.holes.push(r))}return e};var L=s(v.exports);class C{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const o=n[r],i=t+o,u=Math.abs(t)<Math.abs(o)?t-(i-o):o-(i-t);u&&(n[e++]=u),t=i}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,r,o=this._n,i=0;if(o>0){for(i=t[--o];o>0&&(n=i,e=t[--o],i=n+e,r=e-(i-n),!r););o>0&&(r<0&&t[o-1]<0||r>0&&t[o-1]>0)&&(e=2*r,n=i+e,e==n-i&&(i=n))}return i}}var k=Math.PI,J=k/2,q=180/k,D=k/180,N=Math.abs,U=Math.atan2,$=Math.cos,K=Math.sin,Q=Math.sqrt;function V(t){return(t=K(t/2))*t}function W(){}function X(t,n){t&&ot.hasOwnProperty(t.type)&&ot[t.type](t,n)}var Y,tt,nt,et,rt={Feature:function(t,n){X(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,o=e.length;++r<o;)X(e[r].geometry,n)}},ot={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){it(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)it(e[r],n,0)},Polygon:function(t,n){ut(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)ut(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,o=e.length;++r<o;)X(e[r],n)}};function it(t,n,e){var r,o=-1,i=t.length-e;for(n.lineStart();++o<i;)r=t[o],n.point(r[0],r[1],r[2]);n.lineEnd()}function ut(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)it(t[e],n,1);n.polygonEnd()}var at={sphere:W,point:W,lineStart:function(){at.point=ct,at.lineEnd=ft},lineEnd:W,polygonStart:W,polygonEnd:W};function ft(){at.point=at.lineEnd=W}function ct(t,n){tt=t*=D,nt=K(n*=D),et=$(n),at.point=lt}function lt(t,n){t*=D;var e=K(n*=D),r=$(n),o=N(t-tt),i=$(o),u=r*K(o),a=et*e-nt*r*i,f=nt*e+et*r*i;Y.add(U(Q(u*u+a*a),f)),tt=t,nt=e,et=r}function st(t){return Y=new C,function(t,n){t&&rt.hasOwnProperty(t.type)?rt[t.type](t,n):X(t,n)}(t,at),+Y}var vt=[null,null],pt={type:"LineString",coordinates:vt};function xt(t,n){var e,r=t[0]*D,o=t[1]*D,i=n[0]*D,u=n[1]*D,a=$(o),f=K(o),c=$(u),l=K(u),s=a*$(r),v=a*K(r),p=c*$(i),x=c*K(i),h=2*((e=Q(V(u-o)+a*c*V(i-r)))>1?J:e<-1?-J:Math.asin(e)),y=K(h),d=h?function(t){var n=K(t*=h)/y,e=K(h-t)/y,r=e*s+n*p,o=e*v+n*x,i=e*f+n*l;return[U(o,r)*q,U(i,Q(r*r+o*o))*q]}:function(){return[r*q,o*q]};return d.distance=h,d}var ht=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],e=null;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r){if(e){var o=180*(f=r,c=e,vt[0]=f,vt[1]=c,st(pt))/Math.PI;if(o>t)for(var i=xt(e,r),u=1/Math.ceil(o/t),a=u;a<1;)n.push(i(a)),a+=u}var f,c;n.push(e=r)})),n},yt="undefined"!=typeof window&&window.THREE?window.THREE:{BufferGeometry:n.BufferGeometry,Float32BufferAttribute:n.Float32BufferAttribute},dt=(new yt.BufferGeometry).setAttribute?"setAttribute":"addAttribute",gt=function(t){function n(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e(this,n)).type="GeoJsonGeometry",r.parameters={geoJson:t,radius:o,resolution:i};var u=({Point:s,MultiPoint:function(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return s(t,n)})).forEach((function(t){var n=f(t,1)[0];bt(e,n)})),[e]},LineString:v,MultiLineString:function(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return v(t,n)})).forEach((function(t){var n=f(t,1)[0];bt(e,n)})),[e]},Polygon:p,MultiPolygon:function(t,n){var e={vertices:[],indices:[]},r={vertices:[],indices:[]};t.map((function(t){return p(t,n)})).forEach((function(t){var n=f(t,2),o=n[0],i=n[1];bt(e,o),i&&bt(r,i)}));var o=[e];return r.vertices.length&&o.push(r),o}}[t.type]||function(){return[]})(t.coordinates,o),a=[],c=[],l=0;function s(t,n){return[{vertices:wt(t[1],t[0],n),indices:[]}]}function v(t,n){for(var e=ht(t,i).map((function(t){var e=f(t,2),r=e[0];return wt(e[1],r,n)})),r=L.flatten([e]).vertices,o=Math.round(r.length/3),u=[],a=1;a<o;a++)u.push(a-1,a);return[{vertices:r,indices:u}]}function p(t,n){for(var e=t.map((function(t){return ht(t,i).map((function(t){var e=f(t,2),r=e[0];return wt(e[1],r,n)}))})),r=L.flatten(e),o=r.vertices,u=r.holes,a=u[0]||1/0,c=o.slice(0,3*a),l=o.slice(3*a),s=new Set(u),v=Math.round(o.length/3),p=[],x=[],h=1;h<v;h++)s.has(h)||(h<a?p.push(h-1,h):x.push(h-1-a,h-a));var y=[{indices:p,vertices:c}];return u.length&&y.push({indices:x,vertices:l}),y}return u.forEach((function(t){var n=a.length;bt({indices:a,vertices:c},t),r.addGroup(n,a.length-n,l++)})),a.length&&r.setIndex(a),c.length&&r[dt]("position",new yt.Float32BufferAttribute(c,3)),r}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&a(t,n)}(n,t),r=n,o&&i(r.prototype,o),u&&i(r,u),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,u}(yt.BufferGeometry);function bt(t,n){var e=Math.round(t.vertices.length/3);mt(t.vertices,n.vertices),mt(t.indices,n.indices.map((function(t){return t+e})))}function mt(t,n){var e,r=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=c(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(a)throw i}}}}(n);try{for(r.s();!(e=r.n()).done;){var o=e.value;t.push(o)}}catch(t){r.e(t)}finally{r.f()}}function wt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-t)*Math.PI/180,o=(90-n)*Math.PI/180;return[e*Math.sin(r)*Math.cos(o),e*Math.cos(r),e*Math.sin(r)*Math.sin(o)]}t.GeoJsonGeometry=gt}));
